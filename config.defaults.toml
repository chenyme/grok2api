# ==================== 应用设置 ====================
[app]
app_url = "http://127.0.0.1:8000"
app_username = "admin"
app_password = "CHANGE_ME_NOW"
api_key = ""
image_format = "url"
video_format = "html"

# ==================== 网络配置 ====================
[network]
timeout = 120
base_proxy_url = ""
asset_proxy_url = ""

# ==================== 反爬虫/安全 ====================
[security]
cf_clearance = ""
browser = "chrome136"
user_agent = "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36"

# 鉴权策略（默认拒绝匿名）
allow_anonymous_api = false
allow_anonymous_admin = false
allow_query_api_key = false
trusted_proxy_ips = ["127.0.0.1", "::1"]

# CORS（生产环境请改为你的域名）
cors_allow_origins = ["http://127.0.0.1:8000", "http://localhost:8000"]
cors_allow_credentials = true

# 请求安全
max_body_size_mb = 50
rate_limit_enabled = true
rate_limit_per_minute = 120
rate_limit_burst = 60
rate_limit_key = "ip"
rate_limit_ttl_sec = 600
rate_limit_backend = "memory"
rate_limit_window_sec = 60
rate_limit_exempt_paths = [
  "/health",
  "/ready",
  "/static",
  "/v1/files",
  "/docs",
  "/openapi.json",
]

# ==================== 对话配置 ====================
[chat]
temporary = true
disable_memory = true
stream = true
thinking = true
video_think_min_sec = 2.5
dynamic_statsig = true
filter_tags = ["xaiartifact", "xai:tool_usage_card", "grok:render"]

# ==================== 重试策略 ====================
[retry]
max_retry = 3
retry_status_codes = [401, 429, 403]
retry_backoff_base = 0.5
retry_backoff_factor = 2.0
retry_backoff_max = 30.0
retry_budget = 90.0

# ==================== 超时配置 ====================
[timeout]
stream_idle_timeout = 120.0
video_idle_timeout = 90.0
video_result_wait_timeout = 90.0
video_result_poll_interval = 1.0
video_result_scan_pages = 12
video_result_scan_assets = 800
video_result_candidate_attempts = 4

# ==================== 图片生成 ====================
[image]
image_ws = true
image_ws_nsfw = true
image_ws_blocked_seconds = 15
image_ws_final_min_bytes = 100000
image_ws_medium_min_bytes = 30000
image_ws_max_per_request = 6

# ==================== Token 池管理 ====================
[token]
auto_refresh = true
refresh_interval_hours = 8
super_refresh_interval_hours = 2
fail_threshold = 5
save_delay_ms = 2000
reload_interval_sec = 120
selection_strategy = "max_quota"

# ==================== 缓存管理 ====================
[cache]
enable_auto_clean = true
image_limit_mb = 2048
video_limit_mb = 4096
cleanup_target_ratio = 0.8
cleanup_interval_sec = 30
cleanup_max_delete = 1000

# ==================== 并发性能 ====================
[performance]
assets_max_concurrent = 100
media_max_concurrent = 200
usage_max_concurrent = 100
assets_delete_batch_size = 50
assets_batch_size = 50
assets_max_tokens = 5000
usage_batch_size = 100
usage_max_tokens = 5000
nsfw_max_concurrent = 50
nsfw_batch_size = 100
nsfw_max_tokens = 5000
sse_keepalive_sec = 15

# ==================== 代理池 ====================
[proxy]
proxy_url = ""
proxy_pool_url = ""
proxy_pool_interval = 300

# ==================== 统计 ====================
[stats]
enabled = true
hourly_retention = 48
daily_retention = 30
log_max_entries = 1000
flush_interval_sec = 2
